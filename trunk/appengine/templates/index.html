<!DOCTYPE html>
<html>
<!---
  Copyright 2009 Roman Nurik

  Licensed under the Apache License, Version 2.0 (the "License");
  you may not use this file except in compliance with the License.
  You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an "AS IS" BASIS,
  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  See the License for the specific language governing permissions and
  limitations under the License.
-->
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8"/>
    <title>jobfeed</title>
    
    <link rel="SHORTCUT ICON" href="/static/images/shortlogo16.png"/>
    
    <link type="text/css" rel="stylesheet" href="http://yui.yahooapis.com/2.7.0/build/reset/reset-min.css"/>
    <link type="text/css" rel="stylesheet" href="/static/jqueryui-theme/jquery-ui-1.7.2.custom.css"/>
    <link type="text/css" rel="stylesheet" href="/static/css/app.css"/>
    <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.3.2/jquery.min.js"></script>
    <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jqueryui/1.7.2/jquery-ui.min.js"></script>
    <script type="text/javascript" src="http://www.google.com/jsapi?key={% jsapi_key %}"></script>
    <script type="text/javascript" src="/static/lib/jquery.scrollTo-1.4.2-min.js"></script>
    <script type="text/javascript" src="/static/lib/microtemplate.js"></script>
    <script type="text/javascript" src="/static/js/front.js"></script>
    <script type="text/javascript" src="/static/js/date.format.js"></script>
    
    <script type="text/javascript" src="/static/js/skills.js"></script>
    
    <script type="text/javascript">
      google.load('maps', '2');
      google.setOnLoadCallback(init);
    </script>
    
      <script type="text/javascript">
  var years_bins = {{years_bins}};
  var skill_type_summaries = {{skill_type_summaries}}

  var active_skill_objects = [];
  var last_selected_skill_object = null;

  var active_keyword_objects = [];
  var last_selected_keyword_object = null;

  function SkillObject(label, key) {
    this.label = label;
    this.key = key;
  }

  function KeywordObject(label, key) {
    this.label = label;
    this.key = key;
  }



  </script>
    
    <script type="text/javascript">


      function loadSearchProfile() {
        var dropdown = document.getElementById("saved_searches_dropdown");
        pickNewProfile(dropdown);
      }
      
      function init() {
        loadSearchProfile();
document.getElementById("skillInput").value = "";
document.getElementById("keywordInput").value = "";

      }




function skillTypeChange(dropdown) {
        var blurb = document.getElementById("type_summary_foo");
        blurb.innerHTML = skill_type_summaries[dropdown.selectedIndex];
}


function addActiveSkillObject(button) {

  if (last_selected_skill_object) {
    active_skill_objects.push( last_selected_skill_object )
  } else {
    return;
  }



  var skills_table = document.getElementById("pending_skills_list");


  removeChildren( skills_table );

  for (var i=0; i<active_skill_objects.length; i++) {
    makeSkillListItem( active_skill_objects[i], skills_table );
  }
  button.disabled = true;


document.getElementById("skillInput").value = "";
}




function addActiveKeywordObject(button) {

  if (last_selected_keyword_object) {
    active_keyword_objects.push( last_selected_keyword_object )
  } else {
    return;
  }

  var keywords_table = document.getElementById("pending_keywords_list");
  removeChildren( keywords_table );
  for (var i=0; i<active_keyword_objects.length; i++) {
    makeKeywordListItem( active_keyword_objects[i], keywords_table );
  }


  button.disabled = true;


document.getElementById("keywordInput").value = "";
}

    </script>
    
    <style type="text/css">
    th {font-weight: bold}
    </style>
    








<!--CSS file (default YUI Sam Skin) -->
<link type="text/css" rel="stylesheet" href="http://yui.yahooapis.com/2.8.0r4/build/autocomplete/assets/skins/sam/autocomplete.css">
 
<!-- Dependencies -->
<script src="http://yui.yahooapis.com/2.8.0r4/build/yahoo-dom-event/yahoo-dom-event.js"></script>
<script src="http://yui.yahooapis.com/2.8.0r4/build/datasource/datasource-min.js"></script>
 
<!-- OPTIONAL: Connection (required only if using XHRDataSource) -->
<script src="http://yui.yahooapis.com/2.8.0r4/build/connection/connection-min.js"></script>
<script src="http://yui.yahooapis.com/2.8.0r4/build/autocomplete/autocomplete-min.js"></script>

<script src="http://yui.yahooapis.com/2.8.0r4/build/animation/animation-min.js"></script>




  <style type="text/css">
	#skillAutoComplete { 
	    width:25em; /* set width here or else widget will expand to fit its container */ 
	    padding-bottom:2em; 
	}

	#keywordAutoComplete { 
	    width:25em; /* set width here or else widget will expand to fit its container */ 
	    padding-bottom:2em; 
	}
</style>




  </head>
  <body class="yui-skin-sam" onunload="GUnload()" onload="init()">

        {% include "login_bar.html" %}
    













<label for="skillInput">Add a skill:</label>
<span id="type_summary_foo"></span>
<div id="skillAutoComplete">
 
	  <select name="skill_type" id="skill_type_dropdown" onchange="skillTypeChange(this)">
    {% for type in skill_types %}
    <option value="{{type.key}}">{{type.label}}</option>
    {% endfor %}
  </select> <input id="skillInput" type="text" style="width: 10em"> <br />
<div id="skillsContainer"></div>

<button type="button" id="skill_adder_button" onclick="addActiveSkillObject(this)" disabled="true">Add</button>
<input id="experience_years_textbox" type="text" style="width: 2em" onchange="validateYearsTextbox(this)"><label for="experience_years_textbox"> years of experience</label>

</div>


    <script type="text/javascript">
YAHOO.example.BasicRemote = function() {
    // Use an XHRDataSource
    var oDS = new YAHOO.util.XHRDataSource("/skills_autocomplete?");
    // Set the responseType
    oDS.responseType = YAHOO.util.XHRDataSource.TYPE_TEXT;
    // Define the schema of the delimited results
    oDS.responseSchema = {
        recordDelim: "\n",
        fieldDelim: "\t"
    };
    // Enable caching
    oDS.maxCacheEntries = 5;

    // Instantiate the AutoComplete
    var oAC = new YAHOO.widget.AutoComplete("skillInput", "skillsContainer", oDS);
    
	oAC.generateRequest = function(sQuery) {
	    return "query=" + sQuery + "&type=" + document.getElementById("skill_type_dropdown").value;
	};
 
    oAC.forceSelection = true;

    oAC.animVert = false;
    oAC.animHoriz = false;
    oAC.queryQuestionMark = false;



	//define your itemSelect handler function:
	var itemSelectHandler = function(sType, aArgs) {
		YAHOO.log(sType); // this is a string representing the event;
					      // e.g., "itemSelectEvent"
		var oMyAcInstance = aArgs[0]; // your AutoComplete instance
		var elListItem = aArgs[1]; // the <li> element selected in the suggestion container
		var oData = aArgs[2]; // object literal of data for the result

		last_selected_skill_object = new SkillObject(oData[0], oData[1]);
		document.getElementById("skill_adder_button").disabled = false;




                var has_key = false;
                for (var i=0; i<active_skill_objects.length; i++) {
                  if (last_selected_skill_object.key == active_skill_objects[i].key) {
                    has_key = true;
                    break;
                  }
                }
		document.getElementById("skill_adder_button").disabled = has_key;
	};
 
	//subscribe your handler to the event, assuming
	//you have an AutoComplete instance myAC:
	oAC.itemSelectEvent.subscribe(itemSelectHandler);


	//define your selectionEnforce handler function:
	var selectionEnforceHandler = function(sType, aArgs) {
		YAHOO.log(sType); // this is a string representing the event;
					      // e.g., "itemSelectEvent"

		var oSelf = aArgs[0]; // your AutoComplete instance
		var sClearedValue = aArgs[1]; // The cleared value (including delimiters if applicable).

		last_selected_skill_object = null;
		document.getElementById("skill_adder_button").disabled = true;
	};
	oAC.selectionEnforceEvent.subscribe(selectionEnforceHandler);


    return {
        oDS: oDS,
        oAC: oAC
    };
}();


    </script>
    

<table id="pending_skills_list" ></table>
























<br clear="all" />

<label for="keywordInput">Add a keyword:</label>

<div id="keywordAutoComplete">
 <input id="keywordInput" type="text" style="width: 10em">
	<div id="keywordSuggestionContainer"></div>

<br />
<button type="button" id="keyword_adder_button" onclick="addActiveKeywordObject(this)" disabled="true">Add</button>
</div>


    <script type="text/javascript">
YAHOO.example.BasicRemote = function() {
    // Use an XHRDataSource
    var oDS = new YAHOO.util.XHRDataSource("/keyword_autocomplete");
    // Set the responseType
    oDS.responseType = YAHOO.util.XHRDataSource.TYPE_TEXT;
    // Define the schema of the delimited results
    oDS.responseSchema = {
        recordDelim: "\n",
        fieldDelim: "\t"
    };
    // Enable caching
    oDS.maxCacheEntries = 5;

    // Instantiate the AutoComplete
    var oAC = new YAHOO.widget.AutoComplete("keywordInput", "keywordSuggestionContainer", oDS);
     
    oAC.forceSelection = true;
    oAC.animVert = false;
    oAC.animHoriz = false;



	//define your itemSelect handler function:
	var itemSelectHandler = function(sType, aArgs) {
		YAHOO.log(sType); // this is a string representing the event;
					      // e.g., "itemSelectEvent"
		var oMyAcInstance = aArgs[0]; // your AutoComplete instance
		var elListItem = aArgs[1]; // the <li> element selected in the suggestion container
		var oData = aArgs[2]; // object literal of data for the result

		last_selected_keyword_object = new KeywordObject(oData[0], oData[1]);


                var has_key = false;
                for (var i=0; i<active_keyword_objects.length; i++) {
                  if (last_selected_keyword_object.key == active_keyword_objects[i].key) {
                    has_key = true;
                    break;
                  }
                }
		document.getElementById("keyword_adder_button").disabled = has_key;
	};
	 
	//subscribe your handler to the event, assuming
	//you have an AutoComplete instance myAC:
	oAC.itemSelectEvent.subscribe(itemSelectHandler);


	//define your selectionEnforce handler function:
	var selectionEnforceHandler = function(sType, aArgs) {
		YAHOO.log(sType); // this is a string representing the event;
					      // e.g., "itemSelectEvent"

		var oSelf = aArgs[0]; // your AutoComplete instance
		var sClearedValue = aArgs[1]; // The cleared value (including delimiters if applicable).

		last_selected_keyword_object = null;
		document.getElementById("keyword_adder_button").disabled = true;
	};
	oAC.selectionEnforceEvent.subscribe(selectionEnforceHandler);





    return {
        oDS: oDS,
        oAC: oAC
    };
}();


    </script>



<table id="pending_keywords_list"></table>

















    
    
    
    
    
    <div id="user_qualifications_container" style="float:right">
      <a href="/static/help.html">Help</a> | <a href="/profile">Search Profiles</a> <select name="load_key" id="saved_searches_dropdown" onchange="pickNewProfile(this)">
        {% for saved_search in saved_searches %}
        <option value="{{saved_search.key}}">{{saved_search.title}}</option>
        {% endfor %}
      </select><br />
      <span id="status_bar"></span>
      <span id="experience_table_holder"></span>
Jobs that require <strong>any</strong> of the<br/>listed skills will be matched.
    </div>

    <div id="container">
      <div>
        <table><tr><td><img src="/static/images/logo.png"/></td><td>
        
        <form style="margin-left: 20px" action="" onsubmit="doGeocodeAndSearch(); return false;">
          <div id="search-container">
            <p><label for="search-query">Search for job openings near:</label></p>
            <input id="search-query" type="search" value="Houston, TX" />

            <input type="submit" value="Search"/><br/>
                  <input name="enable_skill_filter" type="checkbox" id="checkbox_skill_filter"/><label for="checkbox_skill_filter"> Filter by required experience</label> <input name="enable_keyword_filter" type="checkbox" id="checkbox_keyword_filter"/><label for="checkbox_keyword_filter"> Filter by keywords</label><br/>
                  <input name="enable_sample_jobs" type="checkbox" checked="true" id="checkbox_sample_jobs"/><label for="checkbox_sample_jobs"> Search in sample jobs</label><br/>
            <img id="loading" src="/static/images/loading.gif" alt="Loading..."/>
          </div>
        </form>
        </td></tr></table>
      </div>
      
      <div id="view-toggle">
        <a href="#">List view &raquo;</a>
      </div>
      
      <div id="content" class="clearfix">
        <div id="list-view-container">
          <p id="list-view-status">
            Enter a search location to search for nearby jobs.
          </p>
          <ul id="list-view">
          </ul>
        </div>
        
        <div id="map-container">
          <div id="map"></div>
        </div>
      </div>
      
      <center><a href="/register">Register feed</a> | <a href="http://jobfeed.googlecode.com">About</a>
          <p>Copyright &copy; 2010, Karl Ostmo</p>
      </center>
    </div>
    
    
    
    
    
    <script type="text/html" id="tpl_result_info_window">
      <div class="result-info-window">

        {% include "skills_bubble.html" %}

      </div>
    </script>
    
    <script type="text/html" id="tpl_result_list_item">
    
       {% include "skills_listview_item.html" %}
    </script>
  </body>
</html>
