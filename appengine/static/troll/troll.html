<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-us" lang="en-us" >
<head>


<style type="text/css">
body {font-family: sans-serif}
</style>

<script type="text/javascript" src="physics.js"></script>
<script type="text/javascript" src="arms.js"></script>

<script type="text/javascript">

function press_key(event) {
	switch(event.keyCode) {
	case 37:
		keys_pressed.left = true;
		break;
	case 38:
		keys_pressed.up = true;
		break;
	case 39:
		keys_pressed.right = true;
		break;
	case 40:
		keys_pressed.down = true;
		break;
	default:
		return true;
	}

	return false;
}


function validateTimestep(element) {

	if (element.value) {
		var parsed_value = parseFloat(element.value);
		if (parsed_value > 0) {
			// set global value
			timestep = parsed_value;
			return;
		}
	}

	element.value = timestep;
}


function click_down(object, event) {
	keys_pressed.first_click = true

	which_click_button = event.button;
	// Only accept left- and middle-clicks
	if (which_click_button != 0 && which_click_button != 1)
		return;

	mouse_button_down = true;
	point(object, event);
}

function click_up(object, event) {
	mouse_button_down = false;
}

function point(object, event) {

	pos_x = event.offsetX?(event.offsetX):event.pageX-object.offsetLeft;
	pos_y = event.offsetY?(event.offsetY):event.pageY-object.offsetTop;
	last_click_pos = new Vector2D(pos_x, pos_y);
}

function drag(object, event) {
	if (mouse_button_down)
		point(object, event);
}


</script>

</head>
<body onkeydown="return press_key(event);" onload="sceneInit()">

<p>Move with the arrow keys. Left and middle mouse buttons manipulate arms.</p>

<h1>
FFFFFFFUUUUUUUUUUUU's: <span style="color: red" id="score_field">0</span>
</h1>

<canvas id="canvas" width="800" height="600"
	onmousedown="click_down(this, event)"
	onmouseup="click_up(this, event)"
	onmousemove="drag(this, event)"
	style="cursor: crosshair;">Your browser does not support HTML5 Canvas.</canvas>


<form style="display: none">
<label for="timestep_field">Simulation timestep (seconds): </label><input type="text" maxlength="5" id="timestep_field" value="0.005" onblur="validateTimestep(this);"/> (Simulation will explode if this is too high)

<br />
Speed <input type="text" maxlength="10" id="speed_field" value="0" />
<br />
Tip distance <input type="text" maxlength="10" id="distance_field" value="0" />
<br />
Threshold distance <input type="text" maxlength="10" id="threshold_field" value="0" />
</form>


<h3>Related</h3>

<ul>
<li><a href="http://gafferongames.com/game-physics/spring-physics/">Spring Physics</a></li>
<li><a href="http://www.andrew-hoyer.com/experiments/cloth/">Cloth in Canvas</a></li>
<li><a href="http://nehe.gamedev.net/data/lessons/lesson.asp?lesson=40">NeHe Rope Simulation Tutorial</a></li>
</ul>

</body>
</html>
